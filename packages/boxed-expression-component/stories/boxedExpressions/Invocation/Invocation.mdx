import { Meta, Story, Canvas, Source } from "@storybook/blocks";
import * as Invocation from "./Invocation.stories";

<Meta title="MDX/Invocation" of={Invocation} />

# Boxed Invocation

The Boxed Invocation expression is used to invoke any function (e.g., business knowledge model,
FEEL built-in function, boxed function expressions). It invokes a function by its name and passes its parameters
in order. The parameters can be any type of expression [1].

<div style={{ display: "flex", flexDirection: "row" }}>
  <Story of={Invocation.MonthlyInstallment} />
  <small>
    <br />
    <br />
    <br />
    This is an example of an "Monthly Installment" decision with the number type. It has a Boxed Invocation expression, invoking
    a "Installment Calculation" function, and passing the "Rate", "Term" and "Amount" paramenters which are Boxed Literal
    expressions, and those expression return numbers.
  </small>
</div>

The Boxed Invocation expression is mapped to the textual syntax, the above example can be translated to:

<Source code={`Installment Calculation(Rate, Term, Amount)`} />

It's important to notice this expression requires at least one parameter to be used,
making it not possible to invoke a parameterless function, and to do so the textual syntax should be directly used [1]:

<Source code={`function_name()`} />

## Header

If the Boxed Invocation is the root expression of a decision node, the header row will be split into two rows.
The first will represents the decision name and type, and the second will represents the function name to be invoked.
Now, if the Boxed Invocation is a nested expression, it will have only one row, which will be the function name
to be invoked.

> #### Decision header
>
> This row will be a single cell which has the decision name and its type,
> and by right clicking on it a context menu will open enabling to edit its values.
>
> #### Function name header
>
> This row has a cell for the function name to be invoked, and by right clicking on it
> its possible to edit its name.

## Paramters

The paramers rows can't be less then one and doesn't have a maximum number. Each parameter has a name, type and has
a boxed expression associated with it. Right cliking on the parameter name opens a context menu, enabling to edit its
name and type.

**Important**: It's not possible to have a parameterless function.

## Controls

### Parameters

Left clicking on a parameter cell will open the "Rows" context menu.
It's possible to insert above, insert below, insert multiples, delete and reset the parameter.

Another way to add rows is by hovering the mouse on a parameter cell, which will make appear a plus sign
on the top (insert above) or on the bottom (insert below) of the cell, the position of the plus sign will
depend of the mouse position. Right clicking on it will add a new parameter above or below of the actual parameter.

## Examples

<div style={{ display: "flex", flexDirection: "column" }}>
  <div style={{ display: "flex", flexDirection: "row" }}>
    <Story of={Invocation.Base} />
    <small>
      <br />
      <br />
      An empty Boxed Invocation expression.
    </small>
  </div>

  <div style={{ display: "flex", flexDirection: "row" }}>
    <Story of={Invocation.Nested} />
    <small>
      <br />
      <br />
      An empty Boxed Invocation expression nested on a Boxed Context expression.
    </small>
  </div>
</div>

## Reference

[1] [DMN 1.4 Spec](https://www.omg.org/spec/DMN/1.4/Beta1/PDF#page=103)
